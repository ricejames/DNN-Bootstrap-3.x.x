@using DotNetNuke.Web.DDRMenu;
@using System.Dynamic;
@inherits DotNetNuke.Web.Razor.DotNetNukeWebPage<dynamic>

@* User Login References *@
@using DotNetNuke.Entities.Users;
@using DotNetNuke.Security.Membership;
@using DotNetNuke.Services.Authentication;

@{ var root = Model.Source.root; }










@RenderNodes(root.Children)









@{

    int PortalId = DotNetNuke.Entities.Portals.PortalController.Instance.GetCurrentPortalSettings().PortalId;

    string username = Request["username"];
    string password = Request["password"];


    UserLoginStatus loginStatus = UserLoginStatus.LOGIN_FAILURE;

    UserInfo objUser = UserController.ValidateUser(PortalId, username, password, "DNN", "", DotNetNuke.Entities.Portals.PortalSettings.Current.PortalName.ToString(), AuthenticationLoginBase.GetIPAddress(), ref loginStatus);

    if (loginStatus == UserLoginStatus.LOGIN_SUCCESS || loginStatus == UserLoginStatus.LOGIN_SUPERUSER)
    {
        bool isPersistent = false;

        //User login
        UserController.UserLogin(PortalId, objUser, DotNetNuke.Entities.Portals.PortalSettings.Current.PortalName, this.Request.UserHostAddress, isPersistent);


        //this.Response.Write("Login success");
        Response.Redirect(Request.RawUrl);

    }
    else
    {
        //this.Response.Write("Login failure");
    }




}



@{
    UserInfo userInfo = UserController.Instance.GetCurrentUserInfo();
    if (userInfo.UserID != -1)
    {
        @:
        <script>$("#bootstrapLoginForm").hide();</script>
    }
}


@*@Html.Raw("<script>$(\"#bootstrapLoginForm\").hide();</script>")*@








<nav class="navbar navbar-inverse no-border-radius" id="main_navbar" role="navigation">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="@DotNetNuke.Common.Globals.NavigateURL(DotNetNuke.Entities.Portals.PortalSettings.Current.HomeTabId)">
                <i class="fa fa-home"></i> @DotNetNuke.Entities.Portals.PortalSettings.Current.PortalName.ToString()
            </a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navbar-collapse-1">







            <ul class="nav navbar-nav navbar-left">
                <!-- divider -->
                <li class="divider"></li>
                <!-- dropdown default -->
                <li class="dropdown-short">
                    <a data-toggle="dropdown" href="javascript:;" class="dropdown-toggle" aria-expanded="true">
                        <i class="fa fa-bars"></i>&nbsp;<span class="hidden-sm">Short</span><span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-header">Header. Menu items</li>
                        <li class="divider"></li>
                        <li class="dropdown-right-onhover no-fix">
                            <!-- Menu item with submenu -->
                            <a href="javascript:;"><i class="fa fa-bars"></i> With submenu<span class="desc">Show on hover &amp; don't fix</span></a>

                        </li>
                        <li class="divider"></li>
                        <li><a href="#">Default item<span class="desc">Default description</span></a></li>
                        <li class="active"><a href="#" class="">Active item<span class="desc">Active description</span></a></li>
                        <li class="disabled"><a href="#" class="">Disabled item<span class="desc">Disabled description</span></a></li>
                        <li class="open"><a href="#" class="">Open item<span class="desc">Open description</span></a></li>
                        <li class="divider"></li>
                        <li>
                            <p><a href="#&quot;">Regular link<span class="desc">Regular link description</span></a></p>
                        </li>


                    </ul>
                </li>



                @helper RenderNodes(IList<MenuNode> nodes)
{


    if (nodes.Count > 0)
    {

        <ul class="nav navbar-nav navbar-left">
            @foreach (var node in nodes)
            {
                var cssClasses = new List<string>();

                //if (node.First) { cssClasses.Add("first"); }
                //if (node.Last) { cssClasses.Add("last"); }

                //if (node.Selected) { cssClasses.Add("active"); }

                //if (node.HasChildren())
                //{
                //    cssClasses.Add("dropdown-toggle");

                //}

                var classString = new HtmlString((cssClasses.Count == 0) ? "" : (" class=\"" + String.Join(" ", cssClasses.ToArray()) + "\""));

                <li @classString>
                    @if (node.Enabled && node.HasChildren())
                    {
                        <a href="@node.Url" data-toggle="dropdown">@node.Text <span class="caret"></span></a>
                    }

                    else if (node.Enabled)
                    {
                        <a href="@node.Url">@node.Text</a>
                    }

                    else
                    {
                        @node.Text
                    }
                    @*@RenderNodes(node.Children)*@
                </li>
            }
        </ul>
    }
}



@RenderNodes(root.Children)











                <!-- divider -->
                <li class="divider"></li>
                <!-- dropdown disabled -->
                <li class="dropdown-short disabled hidden-sm hidden-md"><a>Disabled</a></li>
                <!-- divider -->
                <li class="divider hidden-sm hidden-md"></li>
                <!-- wide -->
                <li class="dropdown-wide">
                    <a data-toggle="dropdown" href="javascript:;" class="dropdown-toggle"><i class="fa fa-check-square-o"></i>&nbsp;<span class="hidden-sm hidden-md">Wide</span><span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li class="col-xs-6 col-sm-4 col-md-3 col-lg-3">
                            <address>
                                <br>
                                <strong>MegaNavbar, Inc.</strong><br>
                                123 Folsom Ave, Suite 456<br>
                                San Francisco, CA 987654<br>
                                <abbr title="Phone">P:</abbr> (123) 456-7890
                            </address>
                            <address>
                                <strong>Full Name</strong><br>
                                <a href="mailto:#">first.last@example.com</a>
                            </address>
                        </li>
                        <li class="col-xs-6 col-sm-8 col-md-5 col-lg-5">
                            <div role="form">
                                <div class="form-group">
                                    <label for="exampleInputEmail1">Email address</label>
                                    <input type="email" class="form-control" id="exampleInputEmail1" placeholder="Enter email">
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputPassword1">Password</label>
                                    <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-8">
                                        <div class="checkbox"><label><input type="checkbox"> Remember me</label></div>
                                    </div>
                                    <div class="col-sm-4">
                                        <button type="submit" class="pull-right btn btn-default">Submit</button>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                            <div class="embed-responsive embed-responsive-16by9">
                                <iframe class="embed-responsive-item" src="http://mapsurl.appspot.com/google/iframe.html#01L-sstHl9h2O"></iframe>
                            </div>
                        </li>
                    </ul>
                </li>
                <!-- divider -->
                <li class="divider"></li>

            </ul>










            <ul class="nav navbar-nav navbar-right">
                <!-- search form -->
                <div class="navbar-form-expanded navbar-form navbar-left visible-lg-block visible-md-block visible-xs-block" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" data-width="80px" data-width-expanded="170px" placeholder="Search..." name="query">
                        <span class="input-group-btn"><button class="btn btn-default" type="submit"><i class="fa fa-search"></i>&nbsp;</button></span>
                    </div>
                </div>
                <li class="dropdown-grid visible-sm-block">
                    <a data-toggle="dropdown" href="javascript:;" class="dropdown-toggle"><i class="fa fa-search"></i> Search</a>
                    <div class="dropdown-grid-wrapper" role="menu">
                        <ul class="dropdown-menu col-sm-6">
                            <li>
                                <div class="no-margin">
                                    <div class="input-group">
                                        <input type="text" class="form-control">
                                        <span class="input-group-btn"><button class="btn btn-default" type="button">&nbsp;<i class="fa fa-search"></i></button></span>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
                <!-- media -->
                <!-- divider -->
                <li class="divider"></li>
                <!-- account -->
                <li class="dropdown-grid">
                    <a data-toggle="dropdown" href="javascript:;" class="dropdown-toggle"><i class="fa fa-lock"></i>&nbsp;<span class="hidden-sm">Account</span><span class="caret"></span></a>
                    <div class="dropdown-grid-wrapper" role="menu">
                        <ul class="dropdown-menu col-xs-12 col-sm-10 col-md-8 col-lg-7">
                            <li>
                                <div id="carousel-example-account" class="carousel slide">
                                    <div class="row">
                                        <div class="col-lg-8 col-md-8 col-sm-8">
                                            <div class="carousel-inner">
                                                <div class="item active">
                                                    <h3 class="text-right" style="padding-top:0px; border-bottom: 1px solid #555;"><i class="fa fa-lock"></i> Sign in</h3>
                                                    <br>

                                                    <div class="form-horizontal" role="form">
                                                        <div class="form-group">
                                                            <label for="inputEmail3" class="col-sm-3 control-label">Username</label>
                                                            <div class="col-sm-9"><input name="username" type="text" class="input-sm form-control" id="inputEmail3" placeholder="Username" autocomplete="off"></div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="inputPassword3" class="col-sm-3 control-label">Password</label>
                                                            <div class="col-sm-9"><input name="password" type="password" class="input-sm form-control" id="inputPassword3" placeholder="Password" autocomplete="off"></div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="col-sm-offset-3 col-sm-9">
                                                                <button class="btn btn-default pull-right" type="submit"><i class="fa fa-unlock-alt"></i> Sign in</button>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <p class="text-primary" style="cursor: pointer;" data-target="#carousel-example-account" data-slide-to="1"><small>Don’t have a account? Sign up for FREE</small></p>
                                                    <p class="text-primary" style="cursor: pointer;" data-target="#carousel-example-account" data-slide-to="2"><small>Lost Your Username?</small></p>
                                                    <p class="text-primary" style="cursor: pointer;" data-target="#carousel-example-account" data-slide-to="3"><small>Lost Your Password?</small></p>
                                                </div>
                                                <div class="item">
                                                    <h3 class="text-right" style="padding-top:0px; border-bottom: 1px solid #555;"><i class="fa fa-user"></i> Create new account</h3>
                                                    <br>
                                                    <div class="form-horizontal" role="form">
                                                        <div class="form-group">
                                                            <label for="inputEmail3" class="col-sm-5 control-label">Email</label>
                                                            <div class="col-sm-7"><input type="text" class="input-sm form-control" id="Text1" placeholder="Enter your email address" autocomplete="off"></div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="inputPassword3" class="col-sm-5 control-label">Password</label>
                                                            <div class="col-sm-7"><input type="password" class="input-sm form-control" id="Password1" placeholder="Enter password" autocomplete="off"></div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="inputPassword3" class="col-sm-5 control-label">Confirm password</label>
                                                            <div class="col-sm-7"><input type="password" class="input-sm form-control" id="Password2" placeholder="Enter confirm password" autocomplete="off"></div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="col-sm-12">
                                                                <div class="checkbox">
                                                                    <label>
                                                                        <input type="checkbox"> <small>I have read and agree to our <a href="#">Terms of use</a> and <a href="#">Privacy Policy</a>.</small>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="col-sm-offset-5 col-sm-7">
                                                                <button class="btn btn-default pull-right" type="submit"><i class="fa fa-save"></i> Create an account</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Forgot your username -->
                                                <div class="item">
                                                    <h3 class="text-right" style="padding-top:0px; border-bottom: 1px solid #555;"><i class="fa fa-warning"></i> Forgotten your Username?</h3>
                                                    <br>
                                                    <p class="text-justify">Enter your email address, you signed up with (or entered in your settings), and we'll send you an email with your username.</p>
                                                    <br>
                                                    <div id="lost_password" method="post" class="form" role="form">
                                                        <div class="input-group">
                                                            <input type="text" class="form-control" placeholder="Enter your username" autocomplete="off">
                                                            <span class="input-group-btn">
                                                                <button class="btn btn-default" type="button"><i class="fa fa-envelope"></i> Send it to me!</button>
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <br><br>
                                                    <p class="text-justify"><small><i>If you've forgotten your username and password, you must first retrieve your username (using your email address) and then reset your password using those details.</i></small></p>
                                                </div>
                                                <!-- Forgot your password -->
                                                <div class="item">
                                                    <h3 class="text-right" style="padding-top:0px; border-bottom: 1px solid #555;"><i class="fa fa-warning"></i> Forgot your password?</h3>
                                                    <br>
                                                    <p class="text-justify">
                                                        Enter your username, and we'll send you an email with a link and instructions to reset your password.
                                                        If you signed up without an email address (or removed it from settings), visit the FAQ.
                                                    </p>
                                                    <br>
                                                    <div id="Form1" method="post" class="form" role="form">
                                                        <div class="input-group">
                                                            <input type="text" class="form-control" placeholder="Enter your username" autocomplete="off">
                                                            <span class="input-group-btn">
                                                                <button class="btn btn-default" type="button"><i class="fa fa-envelope"></i> Send it to me!</button>
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <br>
                                                    <p class="text-justify"><small><i>If you've forgotten your username and password, you must first <span class="text-primary" style="cursor: pointer;" data-target="#carousel-example-account" data-slide-to="2">retrieve your username</span> (using your email address) and then reset your password using those details.</i></small></p>
                                                </div>
                                                <div class="item">
                                                    <h3 class="text-right" style="padding-top:0px; border-bottom: 1px solid #555;"><i class="fa fa-envelope"></i> Subscribe to our mailing list</h3>
                                                    <br>
                                                    <p class="text-justify"><i><small>Get the freebies from us and latest updates about YourApp! We hate spam as much as you do, trust us we won't give your details away to other people.</small></i></p>
                                                    <br>
                                                    <div class="form-horizontal" role="form">
                                                        <div class="form-group">
                                                            <label for="inputEmail" class="col-sm-5 control-label">Your email address</label>
                                                            <div class="col-sm-7"><input type="text" class="input-sm form-control" id="inputEmail" name="inputEmail" placeholder="Your email address"></div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="inputName" class="col-sm-5 control-label">Your Name</label>
                                                            <div class="col-sm-7"><input type="text" class="input-sm form-control" id="inputName" name="inputName" placeholder="Your Name"></div>
                                                        </div>
                                                        <br>
                                                        <div class="form-group">
                                                            <div class="col-sm-offset-5 col-sm-7">
                                                                <button class="btn btn-default pull-right" type="submit"><i class="fa fa-envelope-o"></i> Subscribe</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="item">
                                                    <h3 class="text-right" style="padding-top:0px; border-bottom: 1px solid #555;"><i class="fa fa-envelope"></i> Contact us</h3>
                                                    <br>
                                                    <div class="row">
                                                        <div class="" role="form">
                                                            <div class="col-xs-6 col-md-6 ">
                                                                <div class="form-group">
                                                                    <input type="text" class="input-sm form-control" id="Text2" name="inputName" placeholder="Enter your name">
                                                                </div>
                                                            </div>
                                                            <div class="col-xs-6 col-md-6 ">
                                                                <div class="form-group">
                                                                    <input type="password" class="input-sm form-control" id="Password3" name="inputEmail" placeholder="Enter your email address">
                                                                </div>
                                                            </div>
                                                            <div class="col-xs-12 col-md-12 ">
                                                                <div class="form-group">
                                                                    <input type="password" class="input-sm form-control" id="inputSubject" name="inputSubject" placeholder="Subject ...">
                                                                </div>
                                                            </div>
                                                            <div class="col-xs-12 col-md-12 ">
                                                                <div class="form-group">
                                                                    <textarea style="resize: none;" class="form-control" id="inputMessage" name="inputMessage" placeholder="Message" rows="3"></textarea>
                                                                </div>
                                                            </div>
                                                            <div class="form-group col-sm-offset-3 col-sm-9">
                                                                <button class="btn btn-default pull-right" type="submit"><i class="fa fa-chevron-circle-right"></i> Submit</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-4 col-md-4 col-sm-4" style="border-left: 1px solid #555;">
                                            <ol class="carousel-indicators navbar-carousel-indicators" style="">
                                                <li data-target="#carousel-example-account" data-slide-to="0" class="active"><a href="#" class="">Sign In<span class="desc">Already have an account? Log in</span></a></li>
                                                <li data-target="#carousel-example-account" data-slide-to="1" class=""><a href="#" class="">Sign Up<span class="desc">Create new account</span></a></li>
                                                <li data-target="#carousel-example-account" data-slide-to="2" class=""><a href="#" class="">Forgot username?<span class="desc">No problem, we can remind you by email</span></a></li>
                                                <li data-target="#carousel-example-account" data-slide-to="3" class=""><a href="#" class="">Forgot password?<span class="desc">Don't worry, it happens!</span></a></li>
                                                <li data-target="#carousel-example-account" data-slide-to="4" class=""><a href="#" class="">Subscribe<span class="desc">Subscribe to our Newsletters</span></a></li>
                                                <li data-target="#carousel-example-account" data-slide-to="5" class=""><a href="#" class="">Contact us<span class="desc">If you have any questions ...</span></a></li>
                                            </ol>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</nav>


<script>
    //Start Fix MegaNavbar on scroll page
    var navHeight = $('#main_navbar').offset().top;
    FixMegaNavbar(navHeight);
    $(window).bind('scroll', function () { FixMegaNavbar(navHeight); });

    function FixMegaNavbar(navHeight) {
        if (!$('#main_navbar').hasClass('navbar-fixed-bottom')) {
            if ($(window).scrollTop() > navHeight) {
                $('#main_navbar').addClass('navbar-fixed-top')
                $('body').css({ 'margin-top': $('#main_navbar').height() + 'px' });
                if ($('#main_navbar').parent('div').hasClass('container')) $('#main_navbar').children('div').addClass('container').removeClass('container-fluid');
                else if ($('#main_navbar').parent('div').hasClass('container-fluid')) $('#main_navbar').children('div').addClass('container-fluid').removeClass('container');
            }
            else {
                $('#main_navbar').removeClass('navbar-fixed-top');
                $('#main_navbar').children('div').addClass('container-fluid').removeClass('container');
                $('body').css({ 'margin-top': '' });
            }
        }
    }



    //Next code used to prevent unexpected menu close when using some components (like accordion, tabs, forms, etc), please add the next JavaScript to your page
    $(window).load(function () {
        $(document).on('click', '.navbar .dropdown-menu', function (e) { e.stopPropagation(); });
    });

    /*SCROLL PAGE TO TOP*/
    $(document).ready(function () {
        $(".toTop").css("display", "none");

        $(window).scroll(function () {
            if ($(window).scrollTop() > 0) { $(".toTop").fadeIn("slow"); } else { $(".toTop").fadeOut("slow"); }
        });

        $(".toTop").click(function () {
            event.preventDefault();
            $("html, body").animate({ scrollTop: 0 }, "slow");
        });
    });

</script>